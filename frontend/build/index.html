
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Daily Report Name Injector</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; background:#f6f7fb; margin:0; padding:2rem; }
    .card { max-width: 520px; margin: 0 auto; background:white; padding:1.5rem; border-radius:16px; box-shadow:0 10px 25px rgba(0,0,0,0.08); }
    h1 { text-align:center; margin:0 0 1rem; color:#0f62fe; }
    label { font-weight:600; display:block; margin:.75rem 0 .25rem; }
    input[type=file] { width:100%; padding:.6rem; border:1px solid #d0d7de; border-radius:10px; background:#fff; }
    button { width:100%; margin-top:1rem; padding:.8rem 1rem; border:0; border-radius:10px; background:#0f62fe; color:white; font-weight:700; cursor:pointer; }
    button[disabled] { opacity:.6; cursor:not-allowed; }
    .link { display:block; text-align:center; margin-top:1rem; padding:.6rem; background:#12a150; color:white; border-radius:10px; text-decoration:none; }
    .error { color:#d90429; text-align:center; margin-top:.5rem; }
    .note { text-align:center; color:#6b7280; margin-top:.75rem; font-size:.9rem; }
  </style>
</head>
<body>
  <div class="card">
    <h1>Daily Report Name Injector</h1>
    <form id="uploader">
      <label>HTML Daily Report</label>
      <input id="html" type="file" accept=".html" required />
      <label>Names Excel (.xlsx)</label>
      <input id="xlsx" type="file" accept=".xlsx" required />
      <button id="btn" type="submit">Generate Updated Report</button>
      <div id="error" class="error"></div>
    </form>
    <a id="download" class="link" style="display:none" download="report_with_names.html">Download Updated Report</a>
    <div class="note">Works offline. Flask serves this page on port 5000.</div>
  </div>
  <script>
    const form = document.getElementById('uploader');
    const btn = document.getElementById('btn');
    const link = document.getElementById('download');
    const err = document.getElementById('error');
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      err.textContent = '';
      link.style.display = 'none';
      const html = document.getElementById('html').files[0];
      const xlsx = document.getElementById('xlsx').files[0];
      if (!html || !xlsx) { err.textContent = 'Please upload both files.'; return; }
      btn.disabled = true;
      btn.textContent = 'Processing...';
      try {
        const fd = new FormData();
        fd.append('html_file', html);
        fd.append('excel_file', xlsx);
        const res = await fetch('/process', { method: 'POST', body: fd });
        if (!res.ok) { throw new Error('Server error'); }
        const blob = await res.blob();
        const url = URL.createObjectURL(blob);
        link.href = url;
        link.style.display = 'block';
      } catch (e) {
        err.textContent = 'Failed to process files.';
      } finally {
        btn.disabled = false;
        btn.textContent = 'Generate Updated Report';
      }
    });
  </script>
</body>
</html>
